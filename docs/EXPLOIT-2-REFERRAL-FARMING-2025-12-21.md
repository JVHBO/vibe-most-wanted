# EXPLOIT #2: Referral Farming Attack

**Date:** December 21, 2025
**Status:** RESOLVED - System removed
**Total Stolen:** ~38,480,000 VBMS (~38.5M)
**Exploiters Identified:** 86 addresses

---

## Summary

Attackers exploited the referral system by:
1. Creating fake Farcaster accounts (bot accounts with random usernames)
2. Self-referring these fake accounts to earn tier rewards
3. Calling `claimReferralReward` mutation directly via Convex API
4. Bypassing all frontend validations

## Attack Vector

```
1. Attacker inspects site â†’ finds Convex URL (public in JS bundle)
2. Attacker finds mutation names: referrals:trackReferral, referrals:claimReferralReward
3. Attacker creates script to:
   - Create fake Farcaster accounts (rthrtherherthrt, Asd4, etc.)
   - Call trackReferral to register fake referrals
   - Call claimReferralReward when tier is reached
4. Repeat 100+ times per main account
```

## Why It Worked

The referral system had fundamental security flaws:

1. **No server-side validation of Farcaster accounts**
   - Mutations trusted client-provided FID/username
   - No verification against Neynar API

2. **No rate limiting**
   - Unlimited referral registrations
   - No cooldown between claims

3. **No anti-sybil protection**
   - Didn't check account age
   - Didn't verify account activity
   - Didn't detect patterns (same IP, same timing)

4. **Direct API access**
   - All Convex mutations are publicly accessible
   - Frontend-only "security" is useless

## Resolution

1. **EMERGENCY:** Disabled `claimReferralReward` with early return
2. **PERMANENT:** Deleted entire referral system:
   - `convex/referrals.ts` - DELETED
   - `components/ReferralsModal.tsx` - DELETED
   - `app/invite/` directory - DELETED
   - All UI references removed from `app/page.tsx`
3. **Blacklisted** all 86 exploiter addresses in `convex/blacklist.ts`

---

## Top Exploiters (by amount stolen)

| Rank | Address | Username | Amount Stolen | Claims |
|------|---------|----------|---------------|--------|
| 1 | 0x93ab9ef9c10bdd9db53e8ec325a42118e0ac1486 | dobronx | 4,115,000 | 100 |
| 2 | 0x94e7f886caf987a0029e37ac820982c80a13c148 | pakhaji | 4,115,000 | 100 |
| 3 | 0x42a6b996b0547d2d3743b79dde377d98818abd32 | yolo | 1,490,000 | 59 |
| 4 | 0x844a8e4da76bd08761f36bdba1f9746d58f9480d | gm | 1,202,500 | 52 |
| 5 | 0x1a2495bf4ed2aaf46e4834ea21d66109fa243f33 | dbd | 1,152,500 | 50 |
| 6 | 0x4a2ba466a447d6a2010f4acfa7625db3c3c7cfc9 | tyrionn | 925,000 | 46 |
| 7 | 0x986686aced770960fe8a55d37545ebd90102ca97 | berly | 832,500 | 43 |
| 8 | 0x8f1af8261edae03a3680d1359228d2dac34eaec5 | anonnux | 790,000 | 52 |
| 9 | 0xb4909a4c636c45943c72921542ece5cd5d228cdb | nody69 | 750,000 | 40 |
| 10 | 0x8c84464ac8a4110285cf83d76b0c91d50ecf5fd9 | ycbibvcyrvyb | 750,000 | 45 |

---

## Full Exploiter List (86 addresses)

### Tier 1: 1M+ VBMS (5 addresses)
- 0x93ab9ef9c10bdd9db53e8ec325a42118e0ac1486 (dobronx) - 4,115,000 VBMS
- 0x94e7f886caf987a0029e37ac820982c80a13c148 (pakhaji) - 4,115,000 VBMS
- 0x42a6b996b0547d2d3743b79dde377d98818abd32 (yolo) - 1,490,000 VBMS
- 0x844a8e4da76bd08761f36bdba1f9746d58f9480d (gm) - 1,202,500 VBMS
- 0x1a2495bf4ed2aaf46e4834ea21d66109fa243f33 (dbd) - 1,152,500 VBMS

### Tier 2: 500k-1M VBMS (17 addresses)
- 0x4a2ba466a447d6a2010f4acfa7625db3c3c7cfc9 (tyrionn) - 925,000 VBMS
- 0x986686aced770960fe8a55d37545ebd90102ca97 (berly) - 832,500 VBMS
- 0x8f1af8261edae03a3680d1359228d2dac34eaec5 (anonnux) - 790,000 VBMS
- 0xb4909a4c636c45943c72921542ece5cd5d228cdb (nody69) - 750,000 VBMS
- 0x8c84464ac8a4110285cf83d76b0c91d50ecf5fd9 (ycbibvcyrvyb) - 750,000 VBMS
- 0xe95dd130f8a1ac6e6c6fd8ac0dd9d14a80b3bc4c (jamie) - 750,000 VBMS
- 0x4d1ef290857226044b0a9c6916ef4b624967bb12 (gyfjiybyb) - 675,000 VBMS
- 0xc48e66a008cc7195c048d8b3a95bc48f96c26fd2 (basreng) - 675,000 VBMS
- 0x8dcfeaba1109ab99d11069c33c8e20bfd64a3ced (ofkdbd) - 632,500 VBMS
- 0xbcfbc3e9d1eac6684bc92d9ab6d117bf1c83675f (xenna) - 632,500 VBMS
- 0xf494e397fd54efea84f39b51df06811b1657c373 (raees18) - 632,500 VBMS
- 0x03bf270d1c8429a0b378410c0ca9a07ca258cf79 (rendy) - 592,500 VBMS
- 0x2e4078e117fc3cf837042f063c522d6521f8baa3 (tayyeba) - 592,500 VBMS
- 0x9a50ff911c2500b494995e4419be65df3214d1d4 (basdabonezzz) - 592,500 VBMS
- 0x72fe79e122f447a3ba3d600d33cb74e5e01f2649 (tkjfjf) - 555,000 VBMS
- 0x92deaf8a0d953cdd64df5232939ab04ab5699604 (bdbs) - 555,000 VBMS
- 0xa24f8ca04e013911c4af840822119836f1624050 (boli) - 555,000 VBMS

### Tier 3: 100k-500k VBMS (40+ addresses)
[See convex/blacklist.ts for full list]

### Tier 4: <100k VBMS (24 addresses)
[See convex/blacklist.ts for full list]

---

## Lessons Learned

### What to ALWAYS do for reward systems:

1. **Server-side validation ONLY**
   - Never trust client data
   - Verify Farcaster accounts via Neynar API
   - Check account age (minimum 7 days)

2. **Rate limiting**
   - Max 1 reward claim per hour
   - Max referrals per day
   - Cooldown between actions

3. **Anti-sybil protection**
   - Verify account has real activity
   - Check for farming patterns
   - Use captcha or human verification

4. **Context verification**
   - For miniapp: verify Farcaster SDK context
   - Check if request comes from legitimate source
   - Use signed messages from Farcaster

5. **Monitoring & alerts**
   - Alert on unusual claim patterns
   - Real-time dashboard for claims
   - Auto-pause system if threshold exceeded

---

## Combined Exploit Summary

| Exploit | Date | Method | Amount Stolen |
|---------|------|--------|---------------|
| #1 Race Condition | Dec 10-12, 2025 | Multiple signature generation | 12,505,507 VBMS |
| #2 Referral Farming | Dec 21, 2025 | Fake account farming | 38,480,000 VBMS |
| **TOTAL** | - | - | **~51M VBMS** |

---

## Action Items Completed

- [x] Disabled referral claims immediately
- [x] Deleted entire referral system from codebase
- [x] Blacklisted all 86 exploiter addresses
- [x] Created this incident report
- [ ] Improve VBMS claim security (miniapp-only with FID verification)

---

*Report generated: December 21, 2025*
*By: Claude Code*
